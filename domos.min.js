if (! require && ! define) {
  if (! window)
    var window = {}

  var exports = window.domos = {},
      require = function (name) {
        return exports
      },
      define = function (name, deps, module) {
        module(require, exports)
      }
}
if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("util",["require","exports","module"],function(e,t){var n=t.$each=function(e,t,n,r){r===undefined&&(n===undefined?(r=t,t=0):r=n,n=e.length);for(var i=t;i<n;++i)r($(e[i]),i)}.bind(this),r=t.compCss=function(e,t){return getComputedStyle(e[0],null)[t]}.bind(this),i=t.css=function(e,t,n){if(n===undefined){var i=e[0].style[t];return i===""?r(e,t):i}e.css(t,n)}.bind(this)});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("transitions",["require","exports","module","./util"],function(e,t){function p(e,t,n){e.__domosTransition[t]&&(delete e.__domosTransition[t],--e.__domosTransition.nKeys===0&&n&&delete e.__domosTransition)}function v(e,t,n,r){var l=Object.create(n),c=[],h=function(){e.css(l);var n=function(){return t.some(function(t){return Math.abs(parseFloat(i(e,t))-parseFloat(l[t]))>u}.bind(this))}.bind(this),a=!1;if(n()){var f=e[0],h=function(l){if(a)return;if(!l){r&&r(!0),a=!0;return}o.indexOf(l.propertyName)!==-1&&parseFloat(i(e,l.propertyName))<u&&e.css("display","none"),n()||(t.forEach(function(e){p(f,e,!0)}.bind(this)),f.removeEventListener("transitionend",h),f.removeEventListener("webkitTransitionEnd",h),a=!0,d(e,function(){c.forEach(function(t){s(e,t,"auto")}.bind(this))}.bind(this),r))}.bind(this);f.__domosTransition?t.forEach(function(e){var t=f.__domosTransition[e];t&&(t(null),f.removeEventListener("transitionend",t),f.removeEventListener("webkitTransitionEnd",t),p(f,e))}.bind(this)):f.__domosTransition={},t.forEach(function(e){f.__domosTransition[e]=h}.bind(this)),f.__domosTransition.nKeys=t.length,f.addEventListener("transitionend",h),f.addEventListener("webkitTransitionEnd",h)}else t.some(function(e){return o.indexOf(e)!==-1&&parseFloat(l[e])<u}.bind(this))&&e.css("display","none"),r&&r()}.bind(this),v=function(){a?setTimeout(h,f):h()}.bind(this);t.forEach(function(e){n[e]==="auto"&&c.push(e)}.bind(this)),c.length?d(e,function(){c.forEach(function(t){var n=i(e,t);s(e,t,"auto"),l[t]=i(e,t),s(e,t,n)}.bind(this))}.bind(this),v):v()}var n=e("./util"),r=n.$each,i=n.compCss,s=n.css,o=["opacity","width","height"],u=1e-5,a=/Firefox\/(?:1[7-9]|20)?/.test(navigator.userAgent),f=20,l=/Chrome\/2[0-6]?/.test(navigator.userAgent),c=t.transition=function(e,t,n,i){var s;typeof t=="string"?(s={},s[t]=n):(s=t,i=n);var a=Object.keys(s),f=a.length;a.some(function(t){o.indexOf(t)!==-1&&parseFloat(s[t])>u&&e.show()}.bind(this)),h(e,a,function(){var t=e.length;if(!i||t===1)v(e,a,s,i);else{var n=e.length,o=function(e){if(n===-1)return;e?(n=-1,i(!0)):--t||i()}.bind(this);r(e,function(e){v(e,a,s,o)}.bind(this))}}.bind(this))},h=t.fixAutos=function(e,t,n){typeof t=="string"&&(t=[t]);if(l){var o=[];r(e,function(e){t.forEach(function(t){var n=e[0].style[t];(n===""||n==="auto")&&o.push({type:t,node:e})}.bind(this))}.bind(this)),o.length?d(e,function(){o.forEach(function(e){s(e.node,e.type,i(e.node,e.type))}.bind(this))}.bind(this),n):n&&n()}else r(e,function(e){t.forEach(function(t){var n=e[0].style[t];(n===""||n==="auto")&&s(e,t,i(e,t))}.bind(this))}.bind(this)),n&&n()},d=t.withoutTransitions=function(e,t,n){l?(r(e,function(e){e[0].__domosBackupTrans=i(e,"transition"),s(e,"transition","none")}.bind(this)),t&&t(),setTimeout(function(){r(e,function(e){s(e,"transition",e[0].__domosBackupTrans),delete e[0].__domosBackupTrans}.bind(this)),n&&n()}.bind(this))):(t&&t(),n&&n())}});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("state",["require","exports","module","./transitions","./util"],function(e,t){var n=e("./transitions").transition,r=e("./util"),i=r.$each,s=r.css,o=function(e){return e===null||e==="null"}.bind(this),u=t.State=function(){function e(e){_.extend(this,Backbone.Events),e||(e={}),this._selectorMap=e.selectorMap||{},this._defaultSelector=e.default||$("body"),this.statePrefix=e.statePrefix||"s-",this.state={}}return e.prototype._isChange=function(e,t){var n=this.state[e]||null;return n===null?o(t)?null:"null":n===t?null:""+n},e.prototype.set=function(e,t,r,i){if(typeof e=="object"){i=r||{},r=t,t=e,i=Object.create(i),i.noStateChangeEvent=!0;var s={},u=Object.keys(t).filter(function(e){var n=t[e],r=this._isChange(e,n);return r===null?(this._trigger("redo",e,""+n),!1):(s[e]=r,!0)}.bind(this)),a=s.length=u.length;if(a===0)return;var f=function(e){if(a===-1)return;e?(a=-1,r&&r(!0)):--a===0&&(this.trigger("state-change",this.state,s),r&&r())}.bind(this);u.forEach(function(e){this.set(e,t[e],f,i)}.bind(this)),this.trigger("before:state-change",this.state,s);return}i||(i={});var l=this._isChange(e,t);if(l===null){this._trigger("redo",e,""+t);return}o(t)?(t="null",delete this.state[e]):this.state[e]=t;var c=this._getTransitions(e,t,i);this._trigger("before",e,t);if(!i.noStateChangeEvent){var s={length:1};s[e]=l,this.trigger("before:state-change",this.state,s)}var h=$();for(var p=0;p<c.length;){var d=c[p].action;d.cssType==="opacity"&&d.cssVal==0?(h=h.add(c[p].node),c.splice(p,1)):++p}var v=function(o){if(o){r&&r(o);return}var u=c.length,a=function(){r&&r(),this._trigger(e,t),i.noStateChangeEvent||this.trigger("state-change",this.state,s)}.bind(this),f=function(e){if(u===-1)return;e?(u=-1,r&&r(e)):--u===0&&a()}.bind(this);u===0?a():c.forEach(function(e){n(e.node,e.action.cssType,e.action.cssVal,f)}.bind(this))}.bind(this);h.length?n(h,"opacity",0,v):v()},e.prototype._selectorFor=function(e){return this._selectorMap[e]||this._defaultSelector},e.prototype._getTransitions=function(e,t,n){var r=[],o=n&&n.sel;o||(o=this._selectorFor(e));var u="data-"+this.statePrefix+e;return i(o.find("["+u+"]"),function(n){var i,o,a=!1,f=n[0],l=f.__domosState;if(l&&l[e]===t)return;a=n.attr(u).split("|").some(function(e){var s=e.indexOf(":");i="opacity",o=1;if(s!==-1){var u=e.substr(s+1),a=u.indexOf("=");if(a===-1)throw new Error("invalid transition type "+u);i=u.substr(0,a),o=u.substr(a+1),e=e.substr(0,s)}return(e[0]==="!"?t!==e.substr(1):t===e)?(r.push({node:n,action:{cssType:i,cssVal:o}}),!0):!1}.bind(this));if(f.__domosUndo){if(!a)r.push({node:n,action:f.__domosUndo});else if(i!==f.__domosUndo.cssType)r.push({node:n,action:f.__domosUndo});else if(o==s(n,i))return;delete f.__domosUndo}if(a){f.__domosState||(f.__domosState={});var c=s(n,i);f.__domosState[e]=t,f.__domosUndo={cssType:i,cssVal:c}}else f.__domosState&&f.__domosState[e]&&delete f.__domosState[e]}.bind(this)),r},e.prototype._trigger=function(e,t,n){n?e+=":":(n=t,t=e,e=""),this.trigger(e+t+"="+n,n),this.trigger(e+t,n)},e.prototype.restore=function(e,t){this.state=e,_.each(e,function(e,n){if(e===null||e==="null")e="null",delete this.state[n];var r=this._getTransitions(n,e,t);this._trigger("before",n,e),r.forEach(function(e){var t=e.action.cssType,n=e.action.cssVal,r=e.node,i=s(r,t);r.show(),s(r,t,n),r[0].__domosUndo={cssType:t,cssVal:i}}.bind(this)),this._trigger(n,e)}.bind(this))},e}()});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("tooltip",["require","exports","module","./transitions"],function(e,t){var n="http://www.w3.org/2000/svg",r=e("./transitions").transition,i=t.Tooltip=function(){function e(e){this.closed=!0,_.extend(this,Backbone.Events),this.opts=_.extend({position:"top-left",arrowMargin:10,arrowHeight:10,className:"tooltip",closeText:"close"},e||{}),this.$=$("<div/>",{"class":this.opts.className}),this._closeLink=$("<a/>",{html:this.opts.closeText,href:"javascript:void(0)"})}return e.prototype.content=function(e){e.html&&this.$.html(e.html),e.title},e.prototype._makeArrow=function(e){var t=document.createElementNS(n,"svg"),r=document.createElementNS(n,"path");t.style.position="absolute";var i=this.opts.arrowHeight,s="0 "+i,o=i+" -"+i,u=i+" "+i,a=parseInt(this.$.css("border-top-width")),f=(i+a)*2;return r.setAttributeNS(null,"d","M "+s+" l "+o+" l "+u),t.appendChild(r),t.style.top=-i+"px",t.style.width=f,t.style.height=i+a,this.$.append(t),e.position==="top-right"?t.style.left=this.$.outerWidth()-e.arrowMargin-f:t.style.left=e.arrowMargin,r.style.strokeWidth=a,r.style.stroke=this.$.css("border-top-color"),r.style.fill=this.$.css("background-color"),t},e.prototype.display=function(e,t,n){this.closed=!1,t&&this.content(t),n=_.extend({topOffset:0,leftOffset:0},this.opts,n||{});var i=n.position==="top-left"||n.position==="top-right",s=n.position==="top-left"||n.position==="bottom-left";$("body").append(this.$),this.$.append(this._closeLink),r(this.$,"opacity",1);var o=e.offset(),u=o.left,o=o.top;o=Math.floor(o+n.topOffset)+n.arrowHeight,u=Math.floor(u+n.leftOffset),i&&this.$.css({top:o+e.outerHeight(),left:0}),s?this.$.css({left:u}):this.$.css({left:u+e.outerWidth()-this.$.outerWidth()}),this._makeArrow(n),this._closeLink.off("click"),n.noClose?this._closeLink.hide():(this._closeLink.show(),this._closeLink.on("click",function(){this.close()}.bind(this)))},e.prototype.close=function(){if(this.closed)return;this.closed=!0,this.trigger("close"),r(this.$,"opacity",0)},e}()});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("templates",["require","exports","module"],function(require,exports){var TemplateCollectionInstantiation=function(){function e(e,t){this._template=e,this.children=[],t=t||{},t.parent?this._parent=t.parent:this._after=t.after||e.template$}return e.prototype.reset=function(e){for(var t=0;t<this.children.length;++t)this.children[t].remove();this.children.length=0,e&&e.forEach(function(e){this.append(e).show()}.bind(this))},e.prototype.insert=function(e,t){if(this.children.length<=t)return this.append(e);var n=this._template.makeElement(e);return this.children[t].before(n),this.children.splice(t,0,n),n},e.prototype.indexOf=function(e){return typeof e=="number"?e:this.children.indexOf(e)},e.prototype.swap=function(e,t){var n=this.indexOf(e),r=this.indexOf(t);if(n===r)return;if(n>r){var i=n;n=r,r=i}var t=this.children.splice(r,1)[0];e=this.children.splice(n,1)[0],this.insert(t,n),this.insert(e,r)},e.prototype.append=function(e){var t=this._template.makeElement(e);return this.children.length===0?this._after?this._after.after(t):this._parent&&this._parent.append(t):this.children[this.children.length-1].after(t),this.children.push(t),t},e}(),transforms={text:function(e){return function(t,n){t.html(e.call(this,n))}}.bind(this),"if":function(e){return function(t,n){e.call(this,n)||t.hide()}}.bind(this),"xlink:href":function(e){return function(t,n){t[0].setAttributeNS("http://www.w3.org/1999/xlink","href",e.call(this,n))}}.bind(this)},setAttr=function(e,t){return function(n,r){n.attr(e,t.call(this,r))}}.bind(this),getNode=function(e,t){return t.forEach(function(t){e=$(e.contents()[t])}.bind(this)),e}.bind(this),valComponent=/[^\$]+|\$[a-zA-Z_][a-zA-Z0-9_]+|\${[^}]+}/g,getValueFactory=function(value){var callbacks=[],_match;while(_match=valComponent.exec(value))(function(){var match=_match[0];if(match[0]==="$")if(match[1]==="{"){var evalSt="with (model) { "+match.slice(2,-1)+" }";callbacks.push(function(model){return eval(evalSt)})}else{var key=match.substring(1);callbacks.push(function(e){return e[key]}.bind(this))}else callbacks.push(function(e){return match}.bind(this))})();return callbacks.length===1?callbacks[0]:function(e){var t="";return callbacks.forEach(function(n){t+=n(e)}.bind(this)),t}.bind(this)}.bind(this),Template=function(){function e(e,t){this.name=e,this.template$=t,this._subs=this.parseTemplate(t),t.hide()}return e.prototype.parseTemplate=function(e){var t=[],n=[],r=function(e){var i=!1,s=e[0].attributes;if(s===null)return;var o=[];for(var u=0;u<s.length;++u){var a=s[u].name,f=s[u].value;if(!i)if(i=/^data-s-/.test(a))continue;var l=/^data-t-([a-z:]+)/.exec(a);if(!l)continue;var c=l[1];o.push(a);if(c==="template")continue;var h=getValueFactory(f),p=transforms[c];p=p?p(h):setAttr(c,h),t.push({pos:_.clone(n),transform:p})}o.forEach(function(t){e.removeAttr(t)}.bind(this)),i&&t.push({pos:_.clone(n),transform:function(t){var n=e[0].__domosUndo;n&&(t[0].__domosUndo=_.clone(n),n.cssType==="opacity"&&n.cssVal==="0"&&(t.css("opacity",1),t.show()))}});var d=0;n.push(d),_.each(e.contents(),function(e){e=$(e),n[n.length-1]=d++,r(e)}.bind(this)),n.pop()}.bind(this);return r(e),t},e.prototype.updateElement=function(e,t){e=e.attributes||e,this._subs.forEach(function(n){var r=n.pos,i=n.transform,s=getNode(t,r);i.call(s,s,e)}.bind(this))},e.prototype.makeElement=function(e){if(e instanceof $)return e;var t=this.template$.clone();return this.updateElement(e,t),t},e.prototype.instantiateCollection=function(e){return new TemplateCollectionInstantiation(this,e)},e}(),Templates=exports.Templates=function(){function e(e){e=e||{},this._templates={},this._container=e.container||$("body")}return e.prototype.get=function(e){var t=this._templates[e];if(t)return t;var n=this._container.find("[data-t-template="+e+"]");if(n.length===0)throw new Error("could not find template");if(n.length!==1)throw new Error("multiple matches for template");return this._templates[e]=new Template(e,n)},e}()});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("select",["require","exports","module","./util","./transitions"],function(e,t){var n=e("./util"),r=n.$each,i=n.css,s=n.compCss,o=e("./transitions").transition,u="http://www.w3.org/2000/svg",a=2,f={color:"inherit",fontWeight:"inherit",textDecoration:"inherit"},l=function(){function e(e,t){_.extend(t,{buttonPadding:4,"class":"domos-select",buttonClass:"button",optionClass:"option"}),this._selectedIndex=e.prop("selectedIndex");var n=$("<a/>",{css:f,text:e.children(":selected").text(),href:"javascript:void(0)"});this.$=$("<div/>",{"class":t.class,css:{"float":"left",overflow:"hidden"}}),this.$.append(n);var l=e[0].attributes,c=this.$[0].attributes;this.$.css("display",e.css("display"));for(var h=0;h<l.length;){var p=l[0];p.name.indexOf("data-")===0?(l.removeNamedItem(p.name),c.setNamedItem(p)):++h}var d=$("<div/>",{"class":t.buttonClass,css:{"float":"right"}});this.$.append(d),e.before(this.$).hide();var v=t.buttonPadding,m=this.$.height()-v*2,g=s(this.$,"height");i(this.$,"height",s(this.$,"height")),d.css({height:m,width:m,padding:t.buttonPadding});if(t.drawButton)t.drawButton(d);else{var y=document.createElementNS(u,"svg"),b=document.createElementNS(u,"path");b.setAttributeNS(null,"d","M 0 "+m%2+" l "+m+" 0 "+" l -"+m/2+" "+m+" z"),y.appendChild(b),d.append(y)}var w=-1,E=function(e,t){if(!t&&e===w)return;w=e,r(this.$.children(),a,function(t,n){n-a===e?t.addClass("active"):t.removeClass("active")}.bind(this))}.bind(this),S=function(t){if(this._selectedIndex===t)return;e.prop("selectedIndex",this._selectedIndex=t),n.text(e.children(":selected").text())}.bind(this),x=e.children("option");this.nOptions=x.length,r(x,function(e,n){var r=$("<div/>",{text:e.text(),"class":t.optionClass});r.on("mouseenter",function(){E(n)}.bind(this)),r.on("click",function(){S(n)}.bind(this)),this.$.append(r)}.bind(this));var T=!1,N=function(){if(T)return;T=!0,o(this.$,"height","auto"),this.$.addClass("open"),E(this._selectedIndex,!0);var e=function(e){if(e.which===40)w<this.nOptions-1&&E(w+1);else{if(e.which!==38)return;w>0&&E(w-1)}S(w),e.preventDefault()}.bind(this);$(document).on("keydown",e),setTimeout(function(){var t=_.once(function(){if(!T)return;$(document).off("keydown",e),r(this.$.children(),a,function(e){e.removeClass("active")}.bind(this)),this.$.removeClass("open"),o(this.$,"height",g),setTimeout(function(){T=!1}.bind(this),200)}.bind(this));$("body").one("click",t),n.one("blur",t)}.bind(this),200)}.bind(this);this.$.on("click focus",N),n.on("click focus",N)}return e.prototype._selectIndex=function(e){var t=this.$.children("a");t.text($(this.$.children()[e+a]).text())},e}(),c=t.enhanceSelects=function(e,t){t=t||{},r(e,function(e){new l(e,t)}.bind(this))}.bind(this)}),define("domos",["require","exports","module","./state","./tooltip","./templates","./transitions","./select","./util"],function(e,t){e("./state"),e("./tooltip"),e("./templates"),e("./transitions"),e("./select"),e("./util")});