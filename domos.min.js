
if (! require && ! define) {
  if (! window) {
    var window = {}
  }
  var exports = window.domos = {},
      require = function (name) {
        return require.modules[name.replace(/^\.\//,"")]
      },
      define = function (name, ignore, module) {
        require.modules[name] = module
        module(require, exports)
      }

  require.modules = {}
}
if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("transitions",["require","exports","module"],function(e,t){var n=["opacity","width","height"],r=1e-5,i=/Firefox\/1[0-9](?:\.[0-9]+)?/.test(navigator.userAgent),s=t.transition=function(e,t,s,o){var u;typeof t=="string"?(u={},u[t]=s):(u=t,o=s);var a=Object.keys(u),f=a.length;a.some(function(e){return n.indexOf(e)!==-1&&parseFloat(u[e])>r}.bind(this))&&e.show(),e.css(u);var l=function(){return a.some(function(t){return Math.abs(parseFloat(e.css(t))-parseFloat(u[t]))>r}.bind(this))}.bind(this),c=function(){if(l()){var t=e[0],i=function(s){if(!s){o&&o(!0);return}n.indexOf(s.propertyName)!==-1&&parseFloat(e.css(s.propertyName))<r&&e.css("display","none"),l()||(delete t.__domosTransition,t.removeEventListener("transitionend",i),t.removeEventListener("webkitTransitionEnd",i),o&&o())}.bind(this);t.__domosTransition&&(t.removeEventListener("transitionend",t.__domosTransition),t.removeEventListener("webkitTransitionEnd",t.__domosTransition),t.__domosTransition(null)),t.__domosTransition=i,t.addEventListener("transitionend",i),t.addEventListener("webkitTransitionEnd",i)}else a.some(function(e){return n.indexOf(e)!==-1&&parseFloat(u[e])<r}.bind(this))&&e.css("display","none"),o&&o()}.bind(this);i?setTimeout(c,10):c()}});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("states",["require","exports","module","./transitions"],function(e,t){var n=e("./transitions").transition,r=function(e,t,r,i){if(!i){n(e,t,r);return}var s=e.length,o=function(){--s||i()}.bind(this);for(var u=0;u<e.length;++u)n($(e[u]),t,r,o)}.bind(this),i=t.transitionTypes={show:{undoAction:function(e){return"hide"},run:function(e,t){r(e,"opacity",1,t)}},hide:{run:function(e,t){r(e,"opacity",0,t)}}},s=t.States=function(){function e(e){_.extend(this,Backbone.Events),e||(e={}),this._selectorMap=e.selectorMap||{},this._defaultSelector=e.default||$("body"),this.statePrefix=e.statePrefix||"s-",this.state={}}return e.prototype.set=function(e,t,n,i){if(t===null||t==="null"){if(!this.state[e]){this.trigger("redo-"+e+"-null");return}t="null",delete this.state[e]}else{if(this.state[e]===t){this.trigger("redo-"+e+"-"+t,t);return}this.state[e]=t}var s=this._getTransitions(e,t),o=function(){n&&n(),this.trigger("state-change",this.state),this.trigger(e+"-"+t,t)}.bind(this);s.hide&&s.show?r(s.hide,"opacity",0,function(){delete s.hide,this._runTransitions(s,o)}.bind(this)):this._runTransitions(s,o)},e.prototype._runTransitions=function(e,t){var n=Object.keys(e),r=n.length;n.forEach(function(n){i[n].run(e[n]),!--r&&t&&t()}.bind(this))},e.prototype._selectorFor=function(e){return this._selectorMap[e]||this._defaultSelector},e.prototype._getTransitions=function(e,t,n){var r={},s=function(e,t){var n=r[e];r[e]=n?n.add(t):t}.bind(this);n||(n=this._selectorFor(e));var o="data-"+this.statePrefix+e;return _.each(n.find("["+o+"]"),function(e){e=$(e);var n={},r={};e.attr(o).split("|").forEach(function(e){var s=e.indexOf(":"),o="show";if(s!==-1){o=e.substr(s+1);if(!i[o])throw new Error("invalid transition type "+o);e=e.substr(s)}var u=e[0]==="!"?t!==e.substr(1):t===e;u?n[o]=!0:r[o]=!0}.bind(this)),Object.keys(n).forEach(function(t){delete r[t],s(t,e)}.bind(this)),Object.keys(r).forEach(function(t){var n=i[t].undoAction;if(n){var r=n(e);r&&s(r,e)}}.bind(this))}.bind(this)),r},e.prototype.restore=function(e){this.state=e,_.each(e,function(e,t){if(e===null||e==="null")e="null",delete this.state[t];var n=this._getTransitions(t,e);n.hide&&(n.hide.hide(),delete n.hide),n.show&&(n.show.show(),delete n.show),this._runTransitions(n),this.trigger(t+"-"+e,e)}.bind(this))},e}()});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("tooltip",["require","exports","module","./transitions"],function(e,t){var n="http://www.w3.org/2000/svg",r=e("./transitions").transition,i=t.Tooltip=function(){function e(e){this.closed=!0,_.extend(this,Backbone.Events),this.opts=_.extend({position:"top-left",arrowMargin:10,arrowHeight:10,className:"tooltip",closeText:"close"},e||{}),this.$=$("<div/>",{"class":this.opts.className}),this._closeLink=$("<a/>",{html:this.opts.closeText,href:"javascript:void(0)"})}return e.prototype.content=function(e){e.html&&this.$.html(e.html),e.title},e.prototype._makeArrow=function(e){var t=document.createElementNS(n,"svg"),r=document.createElementNS(n,"path");t.setAttribute("version","1.1"),t.style.position="absolute";var i=this.opts.arrowHeight,s="0 "+i,o=i+" -"+i,u=i+" "+i,a=parseInt(this.$.css("border-top-width")),f=(i+a)*2;return r.setAttributeNS(null,"d","M "+s+" l "+o+" l "+u),t.appendChild(r),t.style.top=-i+"px",t.style.width=f,t.style.height=i+a,this.$.append(t),e.position==="top-right"?t.style.left=this.$.outerWidth()-e.arrowMargin-f:t.style.left=e.arrowMargin,r.style.strokeWidth=a,r.style.stroke=this.$.css("border-top-color"),r.style.fill=this.$.css("background-color"),t},e.prototype.display=function(e,t,n){this.closed=!1,t&&this.content(t),n=_.extend({topOffset:0,leftOffset:0},this.opts,n||{});var i=n.position==="top-left"||n.position==="top-right",s=n.position==="top-left"||n.position==="bottom-left";$("body").append(this.$),this.$.append(this._closeLink),r(this.$,"opacity",1);var o=e.offset(),u=o.left,o=o.top;o=Math.floor(o+n.topOffset)+n.arrowHeight,u=Math.floor(u+n.leftOffset),i&&this.$.css({top:o+e.outerHeight(),left:0}),s?this.$.css({left:u}):this.$.css({left:u+e.outerWidth()-this.$.outerWidth()}),this._makeArrow(n),this._closeLink.off("click"),n.noClose?this._closeLink.hide():(this._closeLink.show(),this._closeLink.on("click",function(){this.close()}.bind(this)))},e.prototype.close=function(){if(this.closed)return;this.closed=!0,this.trigger("close"),r(this.$,"opacity",0)},e}()});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("templates",["require","exports","module"],function(require,exports){var TemplateCollectionInstantiation=function(){function e(e,t){this._template=e,this.children=[],t=t||{},t.parent?this._parent=t.parent:this._after=t.after||e.template$}return e.prototype.reset=function(e){for(var t=0;t<this.children.length;++t)this.children[t].remove();this.children.length=0,e&&e.forEach(function(e){this.append(e).show()}.bind(this))},e.prototype.insert=function(e,t){if(this.children.length<=t)return this.append(e);var n=this._template.makeElement(e);return this.children[t].before(n),this.children.splice(t,0,n),n},e.prototype.append=function(e){var t=this._template.makeElement(e);return this.children.length===0?this._after?this._after.after(t):this._parent&&this._parent.append(t):this.children[this.children.length-1].after(t),this.children.push(t),t},e}(),transforms={text:function(e){return function(t,n){t.html(e.call(this,n))}}.bind(this)},setAttr=function(e,t){return function(n,r){n.attr(e,t.call(this,r))}}.bind(this),getNode=function(e,t){return t.forEach(function(t){e=$(e.children()[t])}.bind(this)),e}.bind(this),valComponent=/[^\$]+|\$[a-zA-Z_][a-zA-Z0-9_]+|\${[^}]+}/g,getValueFactory=function(value){var callbacks=[],_match;while(_match=valComponent.exec(value))(function(){var match=_match[0];if(match[0]==="$")if(match[1]==="{"){var evalSt="with (model) { "+match.slice(2,-1)+" }";callbacks.push(function(model){return eval(evalSt)})}else{var key=match.substring(1);callbacks.push(function(e){return e[key]}.bind(this))}else callbacks.push(function(e){return match}.bind(this))})();return callbacks.length===1?callbacks[0]:function(e){var t="";return callbacks.forEach(function(n){t+=n(e)}.bind(this)),t}.bind(this)}.bind(this),Template=function(){function e(e,t){this.name=e,this.template$=t,this._subs=this.parseTemplate(t),t.hide()}return e.prototype.parseTemplate=function(e){var t=[],n=[];return recurse=function(e){_.each(e.data(),function(r,i){var s=/^t([A-Z][a-z]+)/.exec(i);if(!s)return;var o=s[1].toLowerCase();e.removeAttr("data-t-"+o);if(o==="template")return;var u=getValueFactory(r),a=transforms[o];a=a?a(u):setAttr(o,u),t.push({pos:_.clone(n),transform:a})}.bind(this));var r=0;n.push(r),_.each(e.children(),function(e){e=$(e),n[n.length-1]=r++,recurse(e)}.bind(this)),n.pop()}.bind(this),recurse(e),t},e.prototype.updateElement=function(e,t){e=e.attributes||e,this._subs.forEach(function(n){var r=n.pos,i=n.transform,s=getNode(t,r);i.call(s,s,e)}.bind(this))},e.prototype.makeElement=function(e){var t=this.template$.clone();return this.updateElement(e,t),t},e.prototype.instantiateCollection=function(e){return new TemplateCollectionInstantiation(this,e)},e}(),Templates=exports.Templates=function(){function e(e){e=e||{},this._templates={},this._container=e.container||$("body")}return e.prototype.get=function(e){var t=this._templates[e];if(t)return t;var n=this._container.find("[data-t-template="+e+"]");if(n.length===0)throw new Error("could not find template");if(n.length!==1)throw new Error("multiple matches for template");return this._templates[e]=new Template(e,n)},e}()}),define("domos",["require","exports","module","./states","./tooltip","./templates","./transitions"],function(e,t){e("./states"),e("./tooltip"),e("./templates"),e("./transitions")});