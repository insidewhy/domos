if (! require && ! define) {
  if (! window)
    var window = {}

  var exports = window.domos = {},
      require = function (name) {
        return exports
      },
      define = function (name, deps, module) {
        module(require, exports)
      }
}
if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("util",["require","exports","module"],function(e,t){var n=t.$each=function(e,t,n,r){r===undefined&&(n===undefined?(r=t,t=0):r=n,n=e.length);for(var i=t;i<n;++i)r($(e[i]),i)}.bind(this)});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("transitions",["require","exports","module","./util"],function(e,t){function f(e,t,n,o){e.css(n);var a=function(){return t.some(function(t){return Math.abs(parseFloat(u(e,t))-parseFloat(n[t]))>i}.bind(this))}.bind(this),f=function(){if(a()){var s=e[0],f=function(t){if(!t){o&&o(!0);return}r.indexOf(t.propertyName)!==-1&&parseFloat(u(e,t.propertyName))<i&&e.css("display","none"),a()||(delete s.__domosTransition,s.removeEventListener("transitionend",f),s.removeEventListener("webkitTransitionEnd",f),o&&o())}.bind(this);s.__domosTransition&&(s.removeEventListener("transitionend",s.__domosTransition),s.removeEventListener("webkitTransitionEnd",s.__domosTransition),s.__domosTransition(null)),s.__domosTransition=f,s.addEventListener("transitionend",f),s.addEventListener("webkitTransitionEnd",f)}else t.some(function(e){return r.indexOf(e)!==-1&&parseFloat(n[e])<i}.bind(this))&&e.css("display","none"),o&&o()}.bind(this);s?setTimeout(f,10):f()}var n=e("./util").$each,r=["opacity","width","height"],i=1e-5,s=/Firefox\/1[0-9](?:\.[0-9]+)?/.test(navigator.userAgent),o=t.transition=function(e,t,s,o){var a;typeof t=="string"?(a={},a[t]=s):(a=t,o=s);var l=Object.keys(a),c=l.length;l.some(function(t){r.indexOf(t)!==-1&&parseFloat(a[t])>i&&(e.show(),n(e,function(e){return u(e,t)}.bind(this)))}.bind(this));var h=e.length;if(!o||h===1)f(e,l,a,o);else{var p=!1,d=e.length,v=function(e){if(p)return;e?o(p=!0):--h||o()}.bind(this);n(e,function(e){f(e,l,a,v)}.bind(this))}},u=t.compCss=function(e,t){return getComputedStyle(e[0],null)[t]}.bind(this),a=t.css=function(e,t,n){if(n===undefined){var r=e[0].style[t];return r===""?u(e,t):r}e.css(t,n)}.bind(this)});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("states",["require","exports","module","./transitions","./util"],function(e,t){var n=e("./transitions"),r=n.transition,i=n.css,s=e("./util").$each,o=t.States=function(){function e(e){_.extend(this,Backbone.Events),e||(e={}),this._selectorMap=e.selectorMap||{},this._defaultSelector=e.default||$("body"),this.statePrefix=e.statePrefix||"s-",this.state={}}return e.prototype.set=function(e,t,n,i){var s=[];if(t===null||t==="null"){if(!this.state[e]){this.trigger("redo-"+e+"-null");return}t="null",s.push(e),delete this.state[e]}else{if(this.state[e]===t){this.trigger("redo-"+e+"-"+t,t);return}this.state[e]=t,s.push(e)}var o=this._getTransitions(e,t);this.trigger("pre-"+e+"-"+t,t);var u=$();for(var a=0;a<o.length;){var f=o[a].action;f.cssType==="opacity"&&f.cssVal==0?(u=u.add(o[a].node),o.splice(a,1)):++a}var l=function(i){if(i){n&&n(i);return}var u=o.length,a=!1,f=function(r){if(r){if(a)return;a=!0,n&&n(r)}else{if(!!--u)return;n&&n()}this.trigger("state-change",this.state,s),this.trigger(e+"-"+t,t)}.bind(this);o.forEach(function(e){r(e.node,e.action.cssType,e.action.cssVal,f)}.bind(this))}.bind(this);u.length?r(u,"opacity",0,l):l()},e.prototype._selectorFor=function(e){return this._selectorMap[e]||this._defaultSelector},e.prototype._getTransitions=function(e,t,n){var r=[];n||(n=this._selectorFor(e));var o="data-"+this.statePrefix+e;return s(n.find("["+o+"]"),function(n){var s,u,a=!1,f=n[0],l=f.__domosState;if(l&&l[e]===t)return;a=n.attr(o).split("|").some(function(e){var i=e.indexOf(":");s="opacity",u=1;if(i!==-1){var o=e.substr(i+1),a=o.indexOf("=");if(a===-1)throw new Error("invalid transition type "+o);o=o.split(a),s=o[0],u=o[1],e=e.substr(i)}return(e[0]==="!"?t!==e.substr(1):t===e)?(r.push({node:n,action:{cssType:s,cssVal:u}}),!0):!1}.bind(this));if(f.__domosUndo){if(!a)r.push({node:n,action:f.__domosUndo});else if(s!==f.__domosUndo.cssType)r.push({node:n,action:f.__domosUndo});else if(u==i(n,s))return;delete f.__domosUndo}if(a){f.__domosState||(f.__domosState={});var c=i(n,s);f.__domosState[e]=t,f.__domosUndo={cssType:s,cssVal:c}}else f.__domosState&&f.__domosState[e]&&delete f.__domosState[e]}.bind(this)),r},e.prototype.restore=function(e){this.state=e,_.each(e,function(e,t){if(e===null||e==="null")e="null",delete this.state[t];var n=this._getTransitions(t,e);this.trigger("pre-"+t+"-"+e,e),n.forEach(function(e){var t=e.action.cssType,n=e.action.cssVal,r=e.node,s=i(r,t);r.show(),i(r,t,n),r[0].__domosUndo={cssType:t,cssVal:s}}.bind(this)),this.trigger(t+"-"+e,e)}.bind(this))},e}()});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("tooltip",["require","exports","module","./transitions"],function(e,t){var n="http://www.w3.org/2000/svg",r=e("./transitions").transition,i=t.Tooltip=function(){function e(e){this.closed=!0,_.extend(this,Backbone.Events),this.opts=_.extend({position:"top-left",arrowMargin:10,arrowHeight:10,className:"tooltip",closeText:"close"},e||{}),this.$=$("<div/>",{"class":this.opts.className}),this._closeLink=$("<a/>",{html:this.opts.closeText,href:"javascript:void(0)"})}return e.prototype.content=function(e){e.html&&this.$.html(e.html),e.title},e.prototype._makeArrow=function(e){var t=document.createElementNS(n,"svg"),r=document.createElementNS(n,"path");t.style.position="absolute";var i=this.opts.arrowHeight,s="0 "+i,o=i+" -"+i,u=i+" "+i,a=parseInt(this.$.css("border-top-width")),f=(i+a)*2;return r.setAttributeNS(null,"d","M "+s+" l "+o+" l "+u),t.appendChild(r),t.style.top=-i+"px",t.style.width=f,t.style.height=i+a,this.$.append(t),e.position==="top-right"?t.style.left=this.$.outerWidth()-e.arrowMargin-f:t.style.left=e.arrowMargin,r.style.strokeWidth=a,r.style.stroke=this.$.css("border-top-color"),r.style.fill=this.$.css("background-color"),t},e.prototype.display=function(e,t,n){this.closed=!1,t&&this.content(t),n=_.extend({topOffset:0,leftOffset:0},this.opts,n||{});var i=n.position==="top-left"||n.position==="top-right",s=n.position==="top-left"||n.position==="bottom-left";$("body").append(this.$),this.$.append(this._closeLink),r(this.$,"opacity",1);var o=e.offset(),u=o.left,o=o.top;o=Math.floor(o+n.topOffset)+n.arrowHeight,u=Math.floor(u+n.leftOffset),i&&this.$.css({top:o+e.outerHeight(),left:0}),s?this.$.css({left:u}):this.$.css({left:u+e.outerWidth()-this.$.outerWidth()}),this._makeArrow(n),this._closeLink.off("click"),n.noClose?this._closeLink.hide():(this._closeLink.show(),this._closeLink.on("click",function(){this.close()}.bind(this)))},e.prototype.close=function(){if(this.closed)return;this.closed=!0,this.trigger("close"),r(this.$,"opacity",0)},e}()});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("templates",["require","exports","module"],function(require,exports){var TemplateCollectionInstantiation=function(){function e(e,t){this._template=e,this.children=[],t=t||{},t.parent?this._parent=t.parent:this._after=t.after||e.template$}return e.prototype.reset=function(e){for(var t=0;t<this.children.length;++t)this.children[t].remove();this.children.length=0,e&&e.forEach(function(e){this.append(e).show()}.bind(this))},e.prototype.insert=function(e,t){if(this.children.length<=t)return this.append(e);var n=this._template.makeElement(e);return this.children[t].before(n),this.children.splice(t,0,n),n},e.prototype.indexOf=function(e){return typeof e=="number"?e:this.children.indexOf(e)},e.prototype.swap=function(e,t){var n=this.indexOf(e),r=this.indexOf(t);if(n===r)return;if(n>r){var i=n;n=r,r=i}var t=this.children.splice(r,1)[0];e=this.children.splice(n,1)[0],this.insert(t,n),this.insert(e,r)},e.prototype.append=function(e){var t=this._template.makeElement(e);return this.children.length===0?this._after?this._after.after(t):this._parent&&this._parent.append(t):this.children[this.children.length-1].after(t),this.children.push(t),t},e}(),transforms={text:function(e){return function(t,n){t.html(e.call(this,n))}}.bind(this)},setAttr=function(e,t){return function(n,r){n.attr(e,t.call(this,r))}}.bind(this),getNode=function(e,t){return t.forEach(function(t){e=$(e.children()[t])}.bind(this)),e}.bind(this),valComponent=/[^\$]+|\$[a-zA-Z_][a-zA-Z0-9_]+|\${[^}]+}/g,getValueFactory=function(value){var callbacks=[],_match;while(_match=valComponent.exec(value))(function(){var match=_match[0];if(match[0]==="$")if(match[1]==="{"){var evalSt="with (model) { "+match.slice(2,-1)+" }";callbacks.push(function(model){return eval(evalSt)})}else{var key=match.substring(1);callbacks.push(function(e){return e[key]}.bind(this))}else callbacks.push(function(e){return match}.bind(this))})();return callbacks.length===1?callbacks[0]:function(e){var t="";return callbacks.forEach(function(n){t+=n(e)}.bind(this)),t}.bind(this)}.bind(this),Template=function(){function e(e,t){this.name=e,this.template$=t,this._subs=this.parseTemplate(t),t.hide()}return e.prototype.parseTemplate=function(e){var t=[],n=[],r=function(e){_.each(e.data(),function(r,i){var s=/^t([A-Z][a-z]+)/.exec(i);if(!s)return;var o=s[1].toLowerCase();e.removeAttr("data-t-"+o);if(o==="template")return;var u=getValueFactory(r),a=transforms[o];a=a?a(u):setAttr(o,u),t.push({pos:_.clone(n),transform:a})}.bind(this));var i=0;n.push(i),_.each(e.children(),function(e){e=$(e),n[n.length-1]=i++,r(e)}.bind(this)),n.pop()}.bind(this);return r(e),t},e.prototype.updateElement=function(e,t){e=e.attributes||e,this._subs.forEach(function(n){var r=n.pos,i=n.transform,s=getNode(t,r);i.call(s,s,e)}.bind(this))},e.prototype.makeElement=function(e){if(e instanceof $)return e;var t=this.template$.clone();return this.updateElement(e,t),t},e.prototype.instantiateCollection=function(e){return new TemplateCollectionInstantiation(this,e)},e}(),Templates=exports.Templates=function(){function e(e){e=e||{},this._templates={},this._container=e.container||$("body")}return e.prototype.get=function(e){var t=this._templates[e];if(t)return t;var n=this._container.find("[data-t-template="+e+"]");if(n.length===0)throw new Error("could not find template");if(n.length!==1)throw new Error("multiple matches for template");return this._templates[e]=new Template(e,n)},e}()});if(typeof exports=="object"&&typeof define!="function")var define=function(e){e(require,exports)};define("select",["require","exports","module","./util"],function(e,t){var n=e("./util").$each,r="http://www.w3.org/2000/svg",i=2,s={color:"inherit",fontWeight:"inherit",textDecoration:"inherit"},o=function(){function e(e,t){_.extend(t,{buttonPadding:4,"class":"domos-select",buttonClass:"button",optionClass:"option"}),this._selectedIndex=e.prop("selectedIndex");var o=$("<a/>",{css:s,text:e.children(":selected").text(),href:"javascript:void(0)"});this.$=$("<div/>",{"class":t.class,css:{"float":"left",overflow:"hidden"}}),this.$.append(o);var u=e[0].attributes,a=this.$[0].attributes;this.$.css("display",e.css("display"));for(var f=0;f<u.length;){var l=u[0];l.name.indexOf("data-")===0?(u.removeNamedItem(l.name),a.setNamedItem(l)):++f}var c=$("<div/>",{"class":t.buttonClass,css:{"float":"right"}});this.$.append(c),e.before(this.$).hide();var h=t.buttonPadding,p=this.$.height()-h*2,d=this.$.css("height");this.$.css({height:this.$.height()}),c.css({height:p,width:p,padding:t.buttonPadding});if(t.drawButton)t.drawButton(c);else{var v=document.createElementNS(r,"svg"),m=document.createElementNS(r,"path");m.setAttributeNS(null,"d","M 0 "+p%2+" l "+p+" 0 "+" l -"+p/2+" "+p+" z"),v.appendChild(m),c.append(v)}var g=-1,y=function(e,t){if(!t&&e===g)return;g=e,n(this.$.children(),i,function(t,n){n-i===e?t.addClass("active"):t.removeClass("active")}.bind(this))}.bind(this),b=function(t){if(this._selectedIndex===t)return;e.prop("selectedIndex",this._selectedIndex=t),o.text(e.children(":selected").text())}.bind(this),w=e.children("option");this.nOptions=w.length,n(w,function(e,n){var r=$("<div/>",{text:e.text(),"class":t.optionClass});r.on("mouseenter",function(){y(n)}.bind(this)),r.on("click",function(){b(n)}.bind(this)),this.$.append(r)}.bind(this));var E=!1,S=function(){if(E)return;E=!0,this.$.css("height","auto").addClass("open"),y(this._selectedIndex,!0);var e=function(e){if(e.which===40)g<this.nOptions-1&&y(g+1);else{if(e.which!==38)return;g>0&&y(g-1)}b(g),e.preventDefault()}.bind(this);$(document).on("keydown",e),setTimeout(function(){var t=_.once(function(){if(!E)return;$(document).off("keydown",e),n(this.$.children(),i,function(e){e.removeClass("active")}.bind(this)),this.$.removeClass("open"),this.$.css("height",d),setTimeout(function(){E=!1}.bind(this),200)}.bind(this));$("body").one("click",t),o.one("blur",t)}.bind(this),200)}.bind(this);this.$.on("click focus",S),o.on("click focus",S)}return e.prototype._selectIndex=function(e){var t=this.$.children("a");t.text($(this.$.children()[e+i]).text())},e}(),u=t.enhanceSelects=function(e,t){t=t||{},n(e,function(e){new o(e,t)}.bind(this))}.bind(this)}),define("domos",["require","exports","module","./states","./tooltip","./templates","./transitions","./select","./util"],function(e,t){e("./states"),e("./tooltip"),e("./templates"),e("./transitions"),e("./select"),e("./util")});